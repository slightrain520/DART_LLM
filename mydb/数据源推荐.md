# 网络安全攻防领域数据源推荐

本文档为 `createdb_pipeline.py` 提供可靠的网络安全数据源推荐，适合用于构建RAG知识库。

---

## 📚 一、权威机构与标准（强烈推荐）

### 1. MITRE ATT&CK
- **网址**: https://attack.mitre.org/
- **描述**: 全球最权威的网络攻击行为知识库，包含详细的攻击技术、战术和程序（TTP）
- **特点**: 
  - 结构化数据，技术分类清晰
  - 包含真实攻击案例和缓解措施
  - 被全球安全行业广泛采用
- **爬取建议**: 已在代码中实现 `crawl_mitre_attack()` 函数

### 2. OWASP Top 10
- **网址**: https://owasp.org/Top10/
- **描述**: Web应用安全领域最权威的风险列表
- **特点**:
  - 专注于Web应用安全
  - 每3-4年更新一次，反映最新威胁
  - 包含详细的防御建议
- **爬取建议**: 已在代码中实现 `crawl_owasp_top10()` 函数

### 3. CWE (Common Weakness Enumeration)
- **网址**: https://cwe.mitre.org/
- **描述**: 软件安全弱点分类系统
- **特点**:
  - CWE Top 25 列表展示最危险弱点
  - 与CVE配合使用
  - 提供技术细节和修复建议
- **爬取建议**: 已在代码中实现 `crawl_cwe_top25()` 函数

### 4. NIST 网络安全资源中心
- **网址**: https://csrc.nist.gov/
- **描述**: 美国国家标准与技术研究院的安全资源
- **特点**:
  - 包含网络安全框架（CSF）
  - 大量技术指南和最佳实践
  - 权威性强，适合企业级安全
- **爬取建议**: 可使用 `crawl_generic_urls()` 爬取具体页面

---

## 🔍 二、漏洞数据库

### 5. NVD (National Vulnerability Database)
- **网址**: https://nvd.nist.gov/
- **描述**: 美国国家漏洞数据库
- **特点**:
  - 包含所有公开的CVE漏洞
  - CVSS评分和详细描述
  - API可编程访问
- **爬取建议**: 
  ```python
  urls = [
      "https://nvd.nist.gov/vuln/detail/CVE-2021-44228",  # Log4Shell
      "https://nvd.nist.gov/vuln/detail/CVE-2017-0144",   # EternalBlue
  ]
  crawl_generic_urls(urls)
  ```

### 6. Exploit Database
- **网址**: https://www.exploit-db.com/
- **描述**: 漏洞利用代码数据库
- **特点**:
  - 包含POC和EXP代码
  - 与CVE关联
  - 免费开放
- **爬取注意**: 请遵守网站robots.txt，不要过度请求

### 7. CVE Details
- **网址**: https://www.cvedetails.com/
- **描述**: CVE漏洞详情查询网站
- **特点**:
  - 按厂商、产品分类
  - 统计数据丰富
  - 界面友好
- **爬取建议**: 爬取特定产品的漏洞列表页

---

## 🌐 三、安全社区与博客

### 8. FreeBuf (中文)
- **网址**: https://www.freebuf.com/
- **描述**: 国内最大的网络安全社区
- **特点**:
  - 中文内容丰富
  - 涵盖漏洞分析、工具介绍、事件报道
  - 更新频繁
- **爬取建议**:
  ```python
  urls = [
      "https://www.freebuf.com/articles/web/123456.html",  # 具体文章
  ]
  ```
- **注意**: 请遵守网站协议，不要爬取过多内容

### 9. 安全客 (中文)
- **网址**: https://www.anquanke.com/
- **描述**: 360旗下的安全技术社区
- **特点**:
  - 技术文章质量高
  - 包含威胁情报和漏洞分析
  - 中文内容
- **爬取建议**: 选择技术分析类文章

### 10. 先知社区 (中文)
- **网址**: https://xz.aliyun.com/
- **描述**: 阿里云安全社区
- **特点**:
  - 技术深度强
  - 漏洞分析和研究论文
  - 需要登录才能访问部分内容

---

## 🏢 四、厂商安全公告

### 11. Microsoft Security Response Center
- **网址**: https://msrc.microsoft.com/
- **描述**: 微软官方安全响应中心
- **特点**:
  - 包含Windows、Office等产品的安全更新
  - 详细的技术分析
  - 及时性强
- **爬取建议**: 爬取每月安全更新公告

### 12. Cisco Security Advisories
- **网址**: https://sec.cloudapps.cisco.com/security/center/publicationListing.x
- **描述**: 思科安全公告
- **特点**:
  - 网络设备漏洞
  - 技术细节丰富

### 13. Red Hat Security Advisories
- **网址**: https://access.redhat.com/security/security-updates/
- **描述**: 红帽安全公告
- **特点**:
  - Linux系统安全
  - 详细的修复方案

---

## 📊 五、威胁情报与报告

### 14. US-CERT / CISA
- **网址**: https://www.cisa.gov/news-events/cybersecurity-advisories
- **描述**: 美国网络安全与基础设施安全局
- **特点**:
  - 政府级威胁情报
  - 及时的安全警报
  - 防护建议
- **爬取建议**: 已在代码示例中包含

### 15. Packet Storm Security
- **网址**: https://packetstormsecurity.com/
- **描述**: 安全工具和漏洞信息聚合
- **特点**:
  - 历史悠久（1997年创建）
  - 包含工具、漏洞、新闻
  - 每日更新

### 16. The Hacker News
- **网址**: https://thehackernews.com/
- **描述**: 网络安全新闻网站
- **特点**:
  - 新闻更新及时
  - 涵盖最新威胁和事件
  - 英文内容

---

## 📖 六、安全标准与指南

### 17. OWASP Testing Guide
- **网址**: https://owasp.org/www-project-web-security-testing-guide/
- **描述**: Web应用安全测试指南
- **特点**:
  - 系统性测试方法论
  - 详细的测试步骤
  - 开源免费

### 18. SANS Reading Room
- **网址**: https://www.sans.org/white-papers/
- **描述**: SANS研究所白皮书
- **特点**:
  - 高质量研究论文
  - 涵盖多个安全领域
  - 部分内容需要注册

### 19. NIST Special Publications (SP 800系列)
- **网址**: https://csrc.nist.gov/publications/sp800
- **描述**: NIST特别出版物
- **特点**:
  - 技术指南和标准
  - 企业级安全参考
  - PDF格式，可直接下载

---

## 🛠️ 七、工具与技术文档

### 20. Metasploit Documentation
- **网址**: https://docs.metasploit.com/
- **描述**: Metasploit渗透测试框架文档
- **特点**:
  - 渗透测试工具使用
  - 漏洞利用模块说明

### 21. Burp Suite Documentation
- **网址**: https://portswigger.net/burp/documentation
- **描述**: Burp Suite Web安全测试工具文档
- **特点**:
  - Web应用测试方法
  - 工具使用指南

---

## ⚠️ 爬取注意事项

### 法律与道德规范
1. **遵守 robots.txt**: 检查网站的爬虫协议
2. **请求频率控制**: 每次请求间隔0.5-1秒，避免给服务器造成压力
3. **用户协议**: 阅读并遵守网站的服务条款
4. **版权尊重**: 不要商业化使用爬取的内容

### 技术建议
1. **设置User-Agent**: 标识你的爬虫身份
2. **错误处理**: 处理好网络异常和HTTP错误
3. **内容去重**: 避免重复爬取相同内容
4. **增量更新**: 只爬取新增或更新的内容

### 推荐爬取策略
```python
# 初学者推荐：从官方权威源开始
recommended_sources = [
    "MITRE ATT&CK",      # 必选
    "OWASP Top 10",      # 必选
    "CWE Top 25",        # 必选
    "NIST CSRC",         # 推荐
    "US-CERT/CISA",      # 推荐
]

# 进阶：添加中文社区内容
advanced_sources = [
    "FreeBuf 精选文章",   # 中文
    "安全客技术分析",     # 中文
]

# 专业：添加厂商公告和威胁情报
professional_sources = [
    "Microsoft MSRC",
    "Cisco Security",
    "Threat Intelligence Reports",
]
```

---

## 📝 使用示例

### 快速开始（推荐配置）
```python
# 在 createdb_pipeline.py 的 pipeline_demo() 函数中

# 1. 核心权威源（约50-100页）
mitre_pages = crawl_mitre_attack(max_pages=30)
owasp_pages = crawl_owasp_top10()
cwe_pages = crawl_cwe_top25()

# 2. 补充数据源
extra_urls = [
    "https://csrc.nist.gov/",
    "https://www.cisa.gov/news-events/cybersecurity-advisories",
]
extra_pages = crawl_generic_urls(extra_urls)
```

### 中等规模（100-500页）
在上述基础上添加：
- 增加MITRE爬取页数到50-100
- 添加10-20篇FreeBuf/安全客精选文章
- 添加5-10个重要CVE的详细页面

### 大规模（500+页）
- 完整爬取MITRE ATT&CK
- 系统爬取OWASP项目文档
- 批量爬取NVD中的高危CVE
- 定期更新厂商安全公告

---

## 🎯 总结

**初学者推荐起步方案**:
1. MITRE ATT&CK (30页) - 攻击技术
2. OWASP Top 10 (11页) - Web安全
3. CWE Top 25 (1页) - 软件弱点
4. 2-3个公开安全资源页面

**预期效果**: 约50-100个高质量页面，分割后生成200-500个文本chunk，足够支持基础的安全问答。

**扩展方向**: 根据应用场景，后续可以针对性添加特定领域的数据源（如移动安全、云安全、工控安全等）。


